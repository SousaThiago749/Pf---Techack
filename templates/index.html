<!DOCTYPE html>
<html>
<head>
    <title>Verifica√ß√£o de URL Suspeita</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; display: flex; }
        main { flex: 2; }
        aside {
            flex: 1;
            margin-left: 40px;
            padding: 20px;
            border-left: 1px solid #ccc;
        }
        input[type="text"] { width: 300px; padding: 8px; margin-right: 10px; }
        button { padding: 8px 12px; margin-top: 10px; }
        table { border-collapse: collapse; margin-top: 20px; width: 100%; max-width: 700px; }
        th, td { padding: 10px; border: 1px solid #ccc; text-align: left; }
        .seguro { color: green; font-weight: bold; }
        .suspeito { color: red; font-weight: bold; }
        h1, h2 { color: #333; }
        ul { padding-left: 20px; }
    </style>
</head>
<body>
    <main>
        <h1>Verifica√ß√£o de URL Suspeita</h1>
        <form method="POST">
            <input type="text" name="url" placeholder="Digite a URL para verificar" required>
            <button type="submit">Verificar</button>
        </form>

        <div style="margin-top: 20px;">
            <a href="/historico" style="text-decoration: none;">
                <button type="button">üìä Ver Hist√≥rico de An√°lises</button>
            </a>
        </div>

        {% if resultado %}
            <h2>Resultado da Verifica√ß√£o:</h2>
            <table>
                <tr><th>Crit√©rio</th><th>Status</th></tr>

                <tr><td>Presente em lista de phishing</td>
                    <td class="{{ 'suspeito' if resultado['phishing_list'] else 'seguro' }}">
                        {{ 'Suspeito' if resultado['phishing_list'] else 'Seguro' }}
                    </td>
                </tr>
                <tr><td>Uso de n√∫meros no dom√≠nio</td>
                    <td class="{{ 'suspeito' if resultado['numeros_no_dominio'] else 'seguro' }}">
                        {{ 'Suspeito' if resultado['numeros_no_dominio'] else 'Seguro' }}
                    </td>
                </tr>
                <tr><td>Subdom√≠nios excessivos</td>
                    <td class="{{ 'suspeito' if resultado['subdominios_excessivos'] else 'seguro' }}">
                        {{ 'Suspeito' if resultado['subdominios_excessivos'] else 'Seguro' }}
                    </td>
                </tr>
                <tr><td>Caracteres especiais na URL</td>
                    <td class="{{ 'suspeito' if resultado['caracteres_especiais'] else 'seguro' }}">
                        {{ 'Suspeito' if resultado['caracteres_especiais'] else 'Seguro' }}
                    </td>
                </tr>
                <tr><td>DNS Din√¢mico</td>
                    <td class="{{ 'suspeito' if resultado['dns_dinamico'] else 'seguro' }}">
                        {{ 'Suspeito' if resultado['dns_dinamico'] else 'Seguro' }}
                    </td>
                </tr>
                <tr><td>Idade do dom√≠nio</td><td>{{ resultado['idade_dominio'] }}</td></tr>
                <tr><td>Certificado SSL v√°lido</td>
                    <td class="{{ 'suspeito' if not resultado['ssl_valido'] else 'seguro' }}">
                        {{ 'Suspeito' if not resultado['ssl_valido'] else 'Seguro' }}
                    </td>
                </tr>
                <tr><td>Nome do dom√≠nio confere com o certificado</td>
                    <td class="{{ 'suspeito' if not resultado['ssl_correspondente'] else 'seguro' }}">
                        {{ 'Suspeito' if not resultado['ssl_correspondente'] else 'Seguro' }}
                    </td>
                </tr>
                <tr><td>Redireciona para outro dom√≠nio</td>
                    <td class="{{ 'suspeito' if resultado['redireciona_para_outro_dominio'] else 'seguro' }}">
                        {{ 'Suspeito' if resultado['redireciona_para_outro_dominio'] else 'Seguro' }}
                    </td>
                </tr>
                <tr><td>Redirecionamentos m√∫ltiplos</td>
                    <td class="{{ 'suspeito' if resultado['redirecionamentos_multiplos'] else 'seguro' }}">
                        {{ 'Suspeito' if resultado['redirecionamentos_multiplos'] else 'Seguro' }}
                    </td>
                </tr>
                <tr><td>Similar a marca conhecida</td>
                    <td class="{{ 'suspeito' if resultado['similar_a_marca_conhecida'] else 'seguro' }}">
                        {{ 'Suspeito' if resultado['similar_a_marca_conhecida'] else 'Seguro' }}
                    </td>
                </tr>
                <tr><td>Formul√°rio detectado</td>
                    <td class="{{ 'suspeito' if resultado['formulario_detectado'] else 'seguro' }}">
                        {{ 'Detectado' if resultado['formulario_detectado'] else 'N√£o detectado' }}
                    </td>
                </tr>
                <tr><td>Campo sens√≠vel (senha, e-mail) detectado</td>
                    <td class="{{ 'suspeito' if resultado['campo_sensivel_detectado'] else 'seguro' }}">
                        {{ 'Detectado' if resultado['campo_sensivel_detectado'] else 'N√£o detectado' }}
                    </td>
                </tr>
                <tr><td>Palavras-chave suspeitas</td>
                    <td class="{{ 'suspeito' if resultado['palavras_sensiveis_detectadas'] != 'Nenhuma' else 'seguro' }}">
                        {{ resultado['palavras_sensiveis_detectadas'] }}
                    </td>
                </tr>
            </table>
        {% endif %}
    </main>

    <aside>
        <h3>Crit√©rios Analisados</h3>
        <ul>
            <li><strong>Lista de phishing:</strong> dom√≠nios conhecidos por phishing.</li>
            <li><strong>N√∫meros no dom√≠nio:</strong> substitui√ß√µes visuais como "g00gle".</li>
            <li><strong>Subdom√≠nios excessivos:</strong> tentativa de enganar com nomes longos.</li>
            <li><strong>Caracteres especiais:</strong> uso de "@" ou "%", comum em URLs falsas.</li>
            <li><strong>DNS din√¢mico:</strong> servi√ßos gratuitos usados para esconder origem.</li>
            <li><strong>Idade do dom√≠nio:</strong> dom√≠nios novos s√£o mais suspeitos.</li>
            <li><strong>SSL v√°lido:</strong> seguran√ßa b√°sica com HTTPS e certificado v√°lido.</li>
            <li><strong>Dom√≠nio no certificado:</strong> confirma que o site √© quem diz ser.</li>
            <li><strong>Redirecionamento:</strong> URLs que mudam de destino podem esconder fraudes.</li>
            <li><strong>Marca parecida:</strong> tentativa de se passar por sites leg√≠timos.</li>
            <li><strong>Formul√°rio:</strong> captura de dados pode ser tentativa de roubo.</li>
            <li><strong>Campo sens√≠vel:</strong> login, email ou senha inseridos no site.</li>
            <li><strong>Palavras-chave:</strong> termos como ‚Äúsenha‚Äù ou ‚Äúcart√£o‚Äù no conte√∫do.</li>
        </ul>
    </aside>
</body>
</html>
