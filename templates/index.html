<!DOCTYPE html>
<html>
<head>
    <title>Verifica칞칚o de Phishing</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        input[type="text"] { width: 300px; padding: 8px; margin-right: 10px; }
        button { padding: 8px 12px; }
        table { border-collapse: collapse; margin-top: 20px; width: 100%; max-width: 700px; }
        th, td { padding: 10px; border: 1px solid #ccc; text-align: left; }
        .seguro { color: green; font-weight: bold; }
        .suspeito { color: red; font-weight: bold; }
        h1, h2 { color: #333; }
    </style>
</head>
<body>
    <h1>Verifica칞칚o de URL Suspeita</h1>
    <form method="POST">
        <input type="text" name="url" placeholder="Digite a URL para verificar" required>
        <button type="submit">Verificar</button>
    </form>

    <div style="margin-top: 20px;">
        <a href="/historico" style="text-decoration: none;">
            <button type="button">游늵 Ver Hist칩rico de An치lises</button>
        </a>
    </div>

    {% if resultado %}
        <h2>Resultado da Verifica칞칚o:</h2>
        <table>
            <tr><th>Crit칠rio</th><th>Status</th></tr>

            <tr>
                <td>Presente em lista de phishing</td>
                <td class="{{ 'suspeito' if resultado['phishing_list'] else 'seguro' }}">
                    {{ 'Suspeito' if resultado['phishing_list'] else 'Seguro' }}
                </td>
            </tr>

            <tr>
                <td>Uso de n칰meros no dom칤nio</td>
                <td class="{{ 'suspeito' if resultado['numeros_no_dominio'] else 'seguro' }}">
                    {{ 'Suspeito' if resultado['numeros_no_dominio'] else 'Seguro' }}
                </td>
            </tr>

            <tr>
                <td>Subdom칤nios excessivos</td>
                <td class="{{ 'suspeito' if resultado['subdominios_excessivos'] else 'seguro' }}">
                    {{ 'Suspeito' if resultado['subdominios_excessivos'] else 'Seguro' }}
                </td>
            </tr>

            <tr>
                <td>Caracteres especiais na URL</td>
                <td class="{{ 'suspeito' if resultado['caracteres_especiais'] else 'seguro' }}">
                    {{ 'Suspeito' if resultado['caracteres_especiais'] else 'Seguro' }}
                </td>
            </tr>

            <tr>
                <td>DNS Din칙mico</td>
                <td class="{{ 'suspeito' if resultado['dns_dinamico'] else 'seguro' }}">
                    {{ 'Suspeito' if resultado['dns_dinamico'] else 'Seguro' }}
                </td>
            </tr>

            <tr>
                <td>Idade do dom칤nio</td>
                <td>{{ resultado['idade_dominio'] }}</td>
            </tr>

            <tr>
                <td>Certificado SSL v치lido</td>
                <td class="{{ 'suspeito' if not resultado['ssl_valido'] else 'seguro' }}">
                    {{ 'Suspeito' if not resultado['ssl_valido'] else 'Seguro' }}
                </td>
            </tr>

            <tr>
                <td>Nome do dom칤nio confere com o certificado</td>
                <td class="{{ 'suspeito' if not resultado['ssl_correspondente'] else 'seguro' }}">
                    {{ 'Suspeito' if not resultado['ssl_correspondente'] else 'Seguro' }}
                </td>
            </tr>

            <tr>
                <td>Redireciona para outro dom칤nio</td>
                <td class="{{ 'suspeito' if resultado['redireciona_para_outro_dominio'] else 'seguro' }}">
                    {{ 'Suspeito' if resultado['redireciona_para_outro_dominio'] else 'Seguro' }}
                </td>
            </tr>

            <tr>
                <td>Redirecionamentos m칰ltiplos</td>
                <td class="{{ 'suspeito' if resultado['redirecionamentos_multiplos'] else 'seguro' }}">
                    {{ 'Suspeito' if resultado['redirecionamentos_multiplos'] else 'Seguro' }}
                </td>
            </tr>

            <tr>
                <td>Similar a marca conhecida</td>
                <td class="{{ 'suspeito' if resultado['similar_a_marca_conhecida'] else 'seguro' }}">
                    {{ 'Suspeito' if resultado['similar_a_marca_conhecida'] else 'Seguro' }}
                </td>
            </tr>


            <tr>
                <td>Formul치rio detectado</td>
                <td class="{{ 'suspeito' if resultado['formulario_detectado'] else 'seguro' }}">
                    {{ 'Detectado' if resultado['formulario_detectado'] else 'N칚o detectado' }}
                </td>
            </tr>

            <tr>
                <td>Campo sens칤vel (senha, e-mail) detectado</td>
                <td class="{{ 'suspeito' if resultado['campo_sensivel_detectado'] else 'seguro' }}">
                    {{ 'Detectado' if resultado['campo_sensivel_detectado'] else 'N칚o detectado' }}
                </td>
            </tr>

            <tr>
                <td>Palavras-chave suspeitas</td>
                <td class="{{ 'suspeito' if resultado['palavras_sensiveis_detectadas'] != 'Nenhuma' else 'seguro' }}">
                    {{ resultado['palavras_sensiveis_detectadas'] }}
                </td>
            </tr>



        </table>
    {% endif %}
</body>
</html>
