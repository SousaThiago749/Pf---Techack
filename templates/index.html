<!DOCTYPE html>
<html>
<head>
    <title>Verifica√ß√£o de URL Suspeita</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; display: flex; }
        main { flex: 2; }
        aside {
            flex: 1;
            margin-left: 40px;
            padding: 20px;
            border-left: 1px solid #ccc;
        }
        input[type="text"] { width: 300px; padding: 8px; margin-right: 10px; }
        button { padding: 8px 12px; margin-top: 10px; }
        table { border-collapse: collapse; margin-top: 20px; width: 100%; max-width: 700px; }
        th, td { padding: 10px; border: 1px solid #ccc; text-align: left; }
        .seguro { color: green; font-weight: bold; }
        .suspeito { color: red; font-weight: bold; }
        h1, h2 { color: #333; }
        ul { padding-left: 20px; }
    </style>
</head>
<body>
    <main>
        <h1>Verifica√ß√£o de URL Suspeita</h1>
        <form method="POST">
            <input type="text" name="url" placeholder="Digite a URL para verificar" required>
            <button type="submit">Verificar</button>
        </form>

        <div style="margin-top: 20px;">
            <a href="/historico" style="text-decoration: none;">
                <button type="button">üìä Ver Hist√≥rico de An√°lises</button>
            </a>
        </div>

        {% if resultado %}
            <h2>Resultado da Verifica√ß√£o:</h2>
            <table>
                <tr><th>Crit√©rio</th><th>Status</th></tr>

                <tr><td>Presente em lista de phishing</td>
                    <td class="{{ 'suspeito' if resultado['phishing_list'] else 'seguro' }}">
                        {{ 'Suspeito' if resultado['phishing_list'] else 'Seguro' }}
                    </td>
                </tr>
                <tr><td>Uso de n√∫meros no dom√≠nio</td>
                    <td class="{{ 'suspeito' if resultado['numeros_no_dominio'] else 'seguro' }}">
                        {{ 'Suspeito' if resultado['numeros_no_dominio'] else 'Seguro' }}
                    </td>
                </tr>
                <tr><td>Subdom√≠nios excessivos</td>
                    <td class="{{ 'suspeito' if resultado['subdominios_excessivos'] else 'seguro' }}">
                        {{ 'Suspeito' if resultado['subdominios_excessivos'] else 'Seguro' }}
                    </td>
                </tr>
                <tr><td>Caracteres especiais na URL</td>
                    <td class="{{ 'suspeito' if resultado['caracteres_especiais'] else 'seguro' }}">
                        {{ 'Suspeito' if resultado['caracteres_especiais'] else 'Seguro' }}
                    </td>
                </tr>
                <tr><td>DNS Din√¢mico</td>
                    <td class="{{ 'suspeito' if resultado['dns_dinamico'] else 'seguro' }}">
                        {{ 'Suspeito' if resultado['dns_dinamico'] else 'Seguro' }}
                    </td>
                </tr>
                <tr><td>Idade do dom√≠nio</td><td>{{ resultado['idade_dominio'] }}</td></tr>
                <tr><td>Certificado SSL v√°lido</td>
                    <td class="{{ 'suspeito' if not resultado['ssl_valido'] else 'seguro' }}">
                        {{ 'Suspeito' if not resultado['ssl_valido'] else 'Seguro' }}
                    </td>
                </tr>
                <tr><td>Nome do dom√≠nio confere com o certificado</td>
                    <td class="{{ 'suspeito' if not resultado['ssl_correspondente'] else 'seguro' }}">
                        {{ 'Suspeito' if not resultado['ssl_correspondente'] else 'Seguro' }}
                    </td>
                </tr>
                <tr><td>Redireciona para outro dom√≠nio</td>
                    <td class="{{ 'suspeito' if resultado['redireciona_para_outro_dominio'] else 'seguro' }}">
                        {{ 'Suspeito' if resultado['redireciona_para_outro_dominio'] else 'Seguro' }}
                    </td>
                </tr>
                <tr><td>Redirecionamentos m√∫ltiplos</td>
                    <td class="{{ 'suspeito' if resultado['redirecionamentos_multiplos'] else 'seguro' }}">
                        {{ 'Suspeito' if resultado['redirecionamentos_multiplos'] else 'Seguro' }}
                    </td>
                </tr>
                <tr><td>Similar a marca conhecida</td>
                    <td class="{{ 'suspeito' if resultado['similar_a_marca_conhecida'] else 'seguro' }}">
                        {{ 'Suspeito' if resultado['similar_a_marca_conhecida'] else 'Seguro' }}
                    </td>
                </tr>
                <tr><td>Formul√°rio detectado</td>
                    <td class="{{ 'suspeito' if resultado['formulario_detectado'] else 'seguro' }}">
                        {{ 'Detectado' if resultado['formulario_detectado'] else 'N√£o detectado' }}
                    </td>
                </tr>
                <tr><td>Campo sens√≠vel (senha, e-mail) detectado</td>
                    <td class="{{ 'suspeito' if resultado['campo_sensivel_detectado'] else 'seguro' }}">
                        {{ 'Detectado' if resultado['campo_sensivel_detectado'] else 'N√£o detectado' }}
                    </td>
                </tr>
                <tr><td>Palavras-chave suspeitas</td>
                    <td class="{{ 'suspeito' if resultado['palavras_sensiveis_detectadas'] != 'Nenhuma' else 'seguro' }}">
                        {{ resultado['palavras_sensiveis_detectadas'] }}
                    </td>
                </tr>
            </table>
        {% endif %}
    </main>

    <aside>
        <h3>Crit√©rios Analisados</h3>
        <ul>
            <li><strong>Lista de phishing:</strong> se a URL aparece em bases como PhishTank ou OpenPhish, √© um forte indicativo de fraude conhecida, confirmada por den√∫ncias anteriores.</li>

            <li><strong>N√∫meros no dom√≠nio:</strong> substitui√ß√µes como "g00gle" ou "fac3book" s√£o t√©cnicas cl√°ssicas de engenharia social, usadas para enganar visualmente o usu√°rio simulando marcas leg√≠timas.</li>

            <li><strong>Subdom√≠nios excessivos:</strong> dom√≠nios como `login.paypal.seguranca.site.com` s√£o criados para confundir o usu√°rio, fazendo parecer que est√° em um site confi√°vel, quando na verdade est√° em um dom√≠nio falso.</li>

            <li><strong>Caracteres especiais:</strong> s√≠mbolos como `@`, `%`, `!` ou at√© URLs com caminhos longos podem mascarar o destino real, redirecionando para p√°ginas maliciosas sem que o usu√°rio perceba.</li>

            <li><strong>DNS din√¢mico:</strong> dom√≠nios gratuitos como `no-ip`, `duckdns`, entre outros, s√£o usados por atacantes por serem f√°ceis de criar e trocar, dificultando rastreio e bloqueio.</li>

            <li><strong>Idade do dom√≠nio:</strong> sites leg√≠timos geralmente t√™m dom√≠nio antigo. Phishing costuma usar dom√≠nios rec√©m-criados para ataques r√°pidos, antes que sejam denunciados.</li>

            <li><strong>SSL v√°lido:</strong> um certificado SSL inv√°lido pode indicar um site falso, n√£o autorizado, ou mal configurado. A aus√™ncia de HTTPS tamb√©m compromete a privacidade da navega√ß√£o.</li>

            <li><strong>Dom√≠nio no certificado:</strong> mesmo com SSL, se o nome do dom√≠nio no certificado n√£o bater com o endere√ßo da URL, o site pode estar se passando por outro (ataques tipo man-in-the-middle).</li>

            <li><strong>Redirecionamento:</strong> phishing costuma usar redirecionamentos para esconder o destino real. Voc√™ clica em um link leg√≠timo, mas acaba redirecionado para um site fraudulento.</li>

            <li><strong>Marca parecida:</strong> dom√≠nios com nomes similares a marcas conhecidas (ex: `gooogle.com`, `faceb00k.net`) tentam enganar usu√°rios desatentos, simulando confian√ßa e legitimidade.</li>

            <li><strong>Formul√°rio:</strong> sites falsos copiam p√°ginas de login leg√≠timas e capturam os dados digitados pelo usu√°rio, enviando-os diretamente para os atacantes.</li>

            <li><strong>Campo sens√≠vel:</strong> se h√° campos do tipo `senha`, `email`, `cart√£o`, isso pode indicar que a p√°gina tenta capturar dados pessoais ou financeiros.</li>

            <li><strong>Palavras-chave:</strong> termos como ‚Äúsenha‚Äù, ‚Äúconfirma√ß√£o de conta‚Äù, ‚Äúatualiza√ß√£o de cart√£o‚Äù s√£o comuns em golpes que pressionam o usu√°rio a fornecer informa√ß√µes rapidamente.</li>
        </ul>
    </aside>

</body>
</html>
